















<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="last-modified" content="2020-10-09 11:36:08 +0000">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- meta "search-domain" used for google site search function google_search() -->
    <meta name="search-domain" value="">
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/lesson.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/syntax.css" />
    <link rel="license" href="#license-info" />

    



    <!-- Favicons for everyone -->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../assets/favicons/dc/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/favicons/dc/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/favicons/dc/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/favicons/dc/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="../assets/favicons/dc/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../assets/favicons/dc/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="../assets/favicons/dc/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../assets/favicons/dc/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="../assets/favicons/dc/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="../assets/favicons/dc/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="../assets/favicons/dc/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="../assets/favicons/dc/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="../assets/favicons/dc/favicon-128.png" sizes="128x128" />
    <meta name="application-name" content="Data Carpentry - R for Social Scientists"/>
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="../assets/favicons/dc/mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="../assets/favicons/dc/mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="../assets/favicons/dc/mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="../assets/favicons/dc/mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="../assets/favicons/dc/mstile-310x310.png" />


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->

  <title>
  Starting with Data &ndash; R for Social Scientists
  </title>

  </head>
  <body>

    







    <div class="container">
      
















  
  










<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      
      
      <a href="http://datacarpentry.org" class="pull-left">
        <img class="navbar-logo" src="../assets/img/dc-icon-black.svg" alt="Data Carpentry logo" />
      </a>
      

      
      <a class="navbar-brand" href="../">Home</a>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

	
        <li><a href="../CODE_OF_CONDUCT.html">Code of Conduct</a></li>

        
	
        <li><a href="../setup.html">Setup</a></li>

        
        
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Episodes <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            
            <li><a href="../00-intro/index.html">Before we Start</a></li>
            
            
            <li><a href="../01-intro-to-r/index.html">Introduction to R</a></li>
            
            
            <li><a href="../02-starting-with-data/index.html">Starting with Data</a></li>
            
            
            <li><a href="../03-dplyr-tidyr/index.html">Data Wrangling with dplyr and tidyr</a></li>
            
            
            <li><a href="../04-ggplot2/index.html">Data Visualisation with ggplot2</a></li>
            
            
            <li><a href="../0x-json/index.html">Processing JSON data</a></li>
            
	    <li role="separator" class="divider"></li>
            <li><a href="../aio/index.html">All in one page (Beta)</a></li>
          </ul>
        </li>
        
	

	
	
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Extras <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../reference.html">Reference</a></li>
            
            
            <li><a href="../about/index.html">About</a></li>
            
            
            <li><a href="../data-visualisation-handout/index.html">Code Handout - Data Visualisation with ggplot2</a></li>
            
            
            <li><a href="../data-wrangling-handout/index.html">Code Handout</a></li>
            
            
            <li><a href="../discuss/index.html">Discussion</a></li>
            
            
            <li><a href="../figures/index.html">Figures</a></li>
            
            
            <li><a href="../guide/index.html">Instructor Notes</a></li>
            
            
            <li><a href="../intro-R-handout/index.html">Code Handout - Introduction to R</a></li>
            
            
            <li><a href="../starting-with-data-handout/index.html">Code Handout - Starting with Data</a></li>
            
          </ul>
        </li>
	

	
        <li><a href="../LICENSE.html">License</a></li>
	
	
	<li><a href="/edit//_episodes_rmd/02-starting-with-data.Rmd" data-checker-ignore>Improve this page <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a></li>
	
	
      </ul>
      <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form>
    </div>
  </div>
</nav>




























  
  











<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../01-intro-to-r/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
    <h3 class="maintitle"><a href="../">R for Social Scientists</a></h3>
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../03-dplyr-tidyr/index.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>

<article>
<div class="row">
  <div class="col-md-1">
  </div>
  <div class="col-md-10">
    <h1 class="maintitle">Starting with Data</h1>
  </div>
  <div class="col-md-1">
  </div>
</div>












<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 50 min
      <br/>
      <strong>Exercises:</strong> 30 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>What is a data.frame?</p>
</li>
	
	<li><p>How can I read a complete csv file into R?</p>
</li>
	
	<li><p>How can I get basic summary information about my dataset?</p>
</li>
	
	<li><p>How can I change the way R treats strings in my dataset?</p>
</li>
	
	<li><p>Why would I want strings to be treated differently?</p>
</li>
	
	<li><p>How are dates represented in R and how can I change the format?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Describe what a data frame is.</p>
</li>
	
	<li><p>Load external data from a .csv file into a data frame.</p>
</li>
	
	<li><p>Summarize the contents of a data frame.</p>
</li>
	
	<li><p>Subset and extract values from data frames.</p>
</li>
	
	<li><p>Describe the difference between a factor and a string.</p>
</li>
	
	<li><p>Convert between strings and factors.</p>
</li>
	
	<li><p>Reorder and rename factors.</p>
</li>
	
	<li><p>Change how character strings are handled in a data frame.</p>
</li>
	
	<li><p>Examine and change date formats.</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<h2 id="what-are-data-frames-and-tibbles">What are data frames and tibbles?</h2>

<p>Data frames are the <em>de facto</em> data structure for tabular data in <code class="language-plaintext highlighter-rouge">R</code>, and what 
we use for data processing, statistics, and plotting.</p>

<p>A data frame is the representation of data in the format of a table where the
columns are vectors that all have the same length. Data frames are analogous to
the more familiar spreadsheet in programs such as Excel, with one key difference.
Because columns are vectors,
each column must contain a single type of data (e.g., characters, integers,
factors). For example, here is a figure depicting a data frame comprising a
numeric, a character, and a logical vector.</p>

<p><img src="../fig/data-frame.svg" alt="" /></p>

<p>A data frame can be created by hand, but most commonly they are generated by the
functions <code class="language-plaintext highlighter-rouge">read_csv()</code> or <code class="language-plaintext highlighter-rouge">read_table()</code>; in other words, when importing
spreadsheets from your hard drive (or the web). We will now demonstrate how to 
import tabular data using <code class="language-plaintext highlighter-rouge">read_csv()</code>.</p>

<h2 id="presentation-of-the-safi-data">Presentation of the SAFI Data</h2>

<p>SAFI (Studying African Farmer-Led Irrigation) is a study looking at farming
and irrigation methods in Tanzania and Mozambique. The survey data
was collected through interviews conducted between November 2016 and
June 2017. For this lesson, we will be using a subset of the
available data. For information about the full teaching dataset used
in other lessons in this workshop, see the
<a href="http://www.datacarpentry.org/socialsci-workshop/data/">dataset description</a>.</p>

<p>We will be using a subset of the cleaned version of the dataset that
was produced through cleaning in OpenRefine. Each row holds
information for a single interview respondent, and the columns
represent:</p>

<table>
  <thead>
    <tr>
      <th>column_name</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>key_id</td>
      <td>Added to provide a unique Id for each observation. (The InstanceID field does this as well but it is not as convenient to use)</td>
    </tr>
    <tr>
      <td>village</td>
      <td>Village name</td>
    </tr>
    <tr>
      <td>interview_date</td>
      <td>Date of interview</td>
    </tr>
    <tr>
      <td>no_membrs</td>
      <td>How many members in the household?</td>
    </tr>
    <tr>
      <td>years_liv</td>
      <td>How many years have you been living in this village or neighboring village?</td>
    </tr>
    <tr>
      <td>respondent_wall_type</td>
      <td>What type of walls does their house have (from list)</td>
    </tr>
    <tr>
      <td>rooms</td>
      <td>How many rooms in the main house are used for sleeping?</td>
    </tr>
    <tr>
      <td>memb_assoc</td>
      <td>Are you a member of an irrigation association?</td>
    </tr>
    <tr>
      <td>affect_conflicts</td>
      <td>Have you been affected by conflicts with other irrigators in the area?</td>
    </tr>
    <tr>
      <td>liv_count</td>
      <td>Number of livestock owned.</td>
    </tr>
    <tr>
      <td>items_owned</td>
      <td>Which of the following items are owned by the household? (list)</td>
    </tr>
    <tr>
      <td>no_meals</td>
      <td>How many meals do people in your household normally eat in a day?</td>
    </tr>
    <tr>
      <td>months_lack_food</td>
      <td>Indicate which months, In the last 12 months have you faced a situation when you did not have enough food to feed the household?</td>
    </tr>
    <tr>
      <td>instanceID</td>
      <td>Unique identifier for the form data submission</td>
    </tr>
  </tbody>
</table>

<p>You are going load the data in R’s memory using the function <code class="language-plaintext highlighter-rouge">read_csv()</code> 
from the <strong><code class="language-plaintext highlighter-rouge">readr</code></strong> package, which is part of the <strong><code class="language-plaintext highlighter-rouge">tidyverse</code></strong>; learn 
more about the <strong><code class="language-plaintext highlighter-rouge">tidyverse</code></strong> collection of packages 
<a href="https://www.tidyverse.org/">here</a>.
<strong><code class="language-plaintext highlighter-rouge">readr</code></strong> gets installed as part as the <strong><code class="language-plaintext highlighter-rouge">tidyverse</code></strong> installation. 
When you load  the <strong><code class="language-plaintext highlighter-rouge">tidyverse</code></strong> (<code class="language-plaintext highlighter-rouge">library(tidyverse)</code>), the core packages 
(the packages used in most data analyses) get loaded, including <strong><code class="language-plaintext highlighter-rouge">readr</code></strong>.</p>

<p>So, before we can use the <code class="language-plaintext highlighter-rouge">read_csv()</code> function, we need to load the package. 
Also, if you recall, the missing data is encoded as “NULL” in the dataset. 
We’ll tell it to the function, so R will automatically convert all the “NULL” 
entries in the dataset into <code class="language-plaintext highlighter-rouge">NA</code>.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w">
</span><span class="n">interviews</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"data/SAFI_clean.csv"</span><span class="p">,</span><span class="w"> </span><span class="n">na</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"NULL"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>If you were to type in the code above, it is likely that the <code class="language-plaintext highlighter-rouge">read.csv()</code> 
function would appear in the automatically populated list of functions. This 
function is different from the <code class="language-plaintext highlighter-rouge">read_csv()</code> function, as it is included in the 
“base” packages that come pre-installed with R. Overall, <code class="language-plaintext highlighter-rouge">read.csv()</code> behaves 
similar to <code class="language-plaintext highlighter-rouge">read_csv()</code>, with a few notable differences. First, <code class="language-plaintext highlighter-rouge">read.csv()</code> 
coerces column names with spaces and/or special characters to different names 
(e.g. <code class="language-plaintext highlighter-rouge">interview date</code> becomes <code class="language-plaintext highlighter-rouge">interview.date</code>). Second, <code class="language-plaintext highlighter-rouge">read.csv()</code> 
stores data as a <code class="language-plaintext highlighter-rouge">data.frame</code>, where <code class="language-plaintext highlighter-rouge">read_csv()</code> stores data as a <code class="language-plaintext highlighter-rouge">tibble</code>. 
We prefer tibbles because they have nice printing properties among other 
desirable qualities. Read more about tibbles <a href="https://tibble.tidyverse.org/">here</a>.</p>

<p>The second statement in the code above creates a data frame but doesn’t output 
any data because, as you might recall, assignments (<code class="language-plaintext highlighter-rouge">&lt;-</code>) don’t display
anything. (Note, however, that <code class="language-plaintext highlighter-rouge">read_csv</code> may show informational
text about the data frame that is created.) If we want to check that our data
has been loaded, we can see the contents of the data frame by typing its name:
<code class="language-plaintext highlighter-rouge">interviews</code> in the console.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">interviews</span><span class="w">
</span><span class="c1">## Try also</span><span class="w">
</span><span class="c1">## View(interviews)</span><span class="w">
</span><span class="c1">## head(interviews)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code># A tibble: 131 x 14
   key_ID village interview_date      no_membrs years_liv respondent_wall… rooms
    &lt;dbl&gt; &lt;chr&gt;   &lt;dttm&gt;                  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt;
 1      1 God     2016-11-17 00:00:00         3         4 muddaub              1
 2      1 God     2016-11-17 00:00:00         7         9 muddaub              1
 3      3 God     2016-11-17 00:00:00        10        15 burntbricks          1
 4      4 God     2016-11-17 00:00:00         7         6 burntbricks          1
 5      5 God     2016-11-17 00:00:00         7        40 burntbricks          1
 6      6 God     2016-11-17 00:00:00         3         3 muddaub              1
 7      7 God     2016-11-17 00:00:00         6        38 muddaub              1
 8      8 Chirod… 2016-11-16 00:00:00        12        70 burntbricks          3
 9      9 Chirod… 2016-11-16 00:00:00         8         6 burntbricks          1
10     10 Chirod… 2016-12-16 00:00:00        12        23 burntbricks          5
# … with 121 more rows, and 7 more variables: memb_assoc &lt;chr&gt;,
#   affect_conflicts &lt;chr&gt;, liv_count &lt;dbl&gt;, items_owned &lt;chr&gt;, no_meals &lt;dbl&gt;,
#   months_lack_food &lt;chr&gt;, instanceID &lt;chr&gt;
</code></pre></div></div>

<blockquote class="callout">
  <h2 id="note">Note</h2>

  <p><code class="language-plaintext highlighter-rouge">read_csv()</code> assumes that fields are delimited by commas. However, in several
countries, the comma is used as a decimal separator and the semicolon (;) is
used as a field delimiter. If you want to read in this type of files in R,
you can use the <code class="language-plaintext highlighter-rouge">read_csv2</code> function. It behaves exactly like <code class="language-plaintext highlighter-rouge">read_csv</code> but
uses different parameters for the decimal and the field separators. If you are
working with another format, they can be both specified by the user. Check out
the help for <code class="language-plaintext highlighter-rouge">read_csv()</code> by typing <code class="language-plaintext highlighter-rouge">?read_csv</code> to learn more. There is also
the <code class="language-plaintext highlighter-rouge">read_tsv()</code> for tab-separated data files, and <code class="language-plaintext highlighter-rouge">read_delim()</code> allows you
to specify more details about the structure of your file.</p>
</blockquote>

<p>Note that <code class="language-plaintext highlighter-rouge">read_csv()</code> actually loads the data as a tibble.
A tibble is an extension of <code class="language-plaintext highlighter-rouge">R</code> data frames used by the <strong><code class="language-plaintext highlighter-rouge">tidyverse</code></strong>. When the 
data is read using <code class="language-plaintext highlighter-rouge">read_csv()</code>, it is stored in an object of class <code class="language-plaintext highlighter-rouge">tbl_df</code>, 
<code class="language-plaintext highlighter-rouge">tbl</code>,  and <code class="language-plaintext highlighter-rouge">data.frame</code>. You can see the class of an object with</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">class</span><span class="p">(</span><span class="n">interviews</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] "spec_tbl_df" "tbl_df"      "tbl"         "data.frame" 
</code></pre></div></div>

<p>As a <code class="language-plaintext highlighter-rouge">tibble</code>, the type of data included in each column is listed in an 
abbreviated fashion below the column names. For instance, here <code class="language-plaintext highlighter-rouge">key_ID</code> is a 
column of integers (abbreviated <code class="language-plaintext highlighter-rouge">&lt;int&gt;</code>), <code class="language-plaintext highlighter-rouge">village</code> is a column of characters 
(<code class="language-plaintext highlighter-rouge">&lt;chr&gt;</code>) and the <code class="language-plaintext highlighter-rouge">interview_date</code> is a column in the “date and time” format 
(<code class="language-plaintext highlighter-rouge">&lt;dttm&gt;</code>).</p>

<h2 id="inspecting-data-frames">Inspecting data frames</h2>

<p>When calling a <code class="language-plaintext highlighter-rouge">tbl_df</code> object (like <code class="language-plaintext highlighter-rouge">interviews</code> here), there is already a lot of information about our data frame being displayed such as the number of rows, the number of columns, the names of the columns, and as we just saw the class of data stored in each column. However, there are functions to extract this information from data frames.  Here is a non-exhaustive list of some of these
functions. Let’s try them out!</p>

<p>Size:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">dim(interviews)</code> - returns a vector with the number of rows as the first element,
and the number of columns as the second element (the <strong>dim</strong>ensions of
the object)</li>
  <li><code class="language-plaintext highlighter-rouge">nrow(interviews)</code> - returns the number of rows</li>
  <li><code class="language-plaintext highlighter-rouge">ncol(interviews)</code> - returns the number of columns</li>
</ul>

<p>Content:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">head(interviews)</code> - shows the first 6 rows</li>
  <li><code class="language-plaintext highlighter-rouge">tail(interviews)</code> - shows the last 6 rows</li>
</ul>

<p>Names:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">names(interviews)</code> - returns the column names (synonym of <code class="language-plaintext highlighter-rouge">colnames()</code> for
<code class="language-plaintext highlighter-rouge">data.frame</code> objects)</li>
</ul>

<p>Summary:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">str(interviews)</code> - structure of the object and information about the class,
length and content of each column</li>
  <li><code class="language-plaintext highlighter-rouge">summary(interviews)</code> - summary statistics for each column</li>
</ul>

<p>Note: most of these functions are “generic.” They can be used on other types of
objects besides data frames.</p>

<h2 id="indexing-and-subsetting-data-frames">Indexing and subsetting data frames</h2>

<p>Our <code class="language-plaintext highlighter-rouge">interviews</code> data frame has rows and columns (it has 2 dimensions). 
In practice, we may not need the entire data frame; for instance, we may only
be interested in a subset of the observations (the rows) or a particular set 
of variables (the columns). If we want to
extract some specific data from it, we need to specify the “coordinates” we
want from it. Row numbers come first, followed by column numbers.</p>

<blockquote class="callout">
  <h2 id="tip">Tip</h2>
  <p>Indexing a <code class="language-plaintext highlighter-rouge">tibble</code> with <code class="language-plaintext highlighter-rouge">[</code> or <code class="language-plaintext highlighter-rouge">[[</code> or <code class="language-plaintext highlighter-rouge">$</code> always results in a <code class="language-plaintext highlighter-rouge">tibble</code>.
However, note this is not true in general for data frames, so be careful!
Different ways of specifying these coordinates can lead to results with
different classes. This is covered in the Software Carpentry lesson
<a href="https://swcarpentry.github.io/r-novice-gapminder/">R for Reproducible Scientific Analysis</a>.</p>
</blockquote>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## first element in the first column of the data frame (as a data.frame)</span><span class="w">
</span><span class="n">interviews</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code># A tibble: 1 x 1
  key_ID
   &lt;dbl&gt;
1      1
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## first element in the 6th column (as a data.frame)</span><span class="w">
</span><span class="n">interviews</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code># A tibble: 1 x 1
  respondent_wall_type
  &lt;chr&gt;               
1 muddaub             
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## first column of the data frame (as a vector)</span><span class="w">
</span><span class="n">interviews</span><span class="p">[[</span><span class="m">1</span><span class="p">]]</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [1]   1   1   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18
 [19]  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36
 [37]  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  21  54
 [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71 127
 [73] 133 152 153 155 178 177 180 181 182 186 187 195 196 197 198 201 202  72
 [91]  73  76  83  85  89 101 103 102  78  80 104 105 106 109 110 113 118 125
[109] 119 115 108 116 117 144 143 150 159 160 165 166 167 174 175 189 191 192
[127] 126 193 194 199 200
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## first column of the data frame (as a data.frame)</span><span class="w">
</span><span class="n">interviews</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code># A tibble: 131 x 1
   key_ID
    &lt;dbl&gt;
 1      1
 2      1
 3      3
 4      4
 5      5
 6      6
 7      7
 8      8
 9      9
10     10
# … with 121 more rows
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## first three elements in the 7th column (as a data.frame)</span><span class="w">
</span><span class="n">interviews</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">7</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code># A tibble: 3 x 1
  rooms
  &lt;dbl&gt;
1     1
2     1
3     1
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## the 3rd row of the data frame (as a data.frame)</span><span class="w">
</span><span class="n">interviews</span><span class="p">[</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code># A tibble: 1 x 14
  key_ID village interview_date      no_membrs years_liv respondent_wall… rooms
   &lt;dbl&gt; &lt;chr&gt;   &lt;dttm&gt;                  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt;
1      3 God     2016-11-17 00:00:00        10        15 burntbricks          1
# … with 7 more variables: memb_assoc &lt;chr&gt;, affect_conflicts &lt;chr&gt;,
#   liv_count &lt;dbl&gt;, items_owned &lt;chr&gt;, no_meals &lt;dbl&gt;, months_lack_food &lt;chr&gt;,
#   instanceID &lt;chr&gt;
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## equivalent to head_interviews &lt;- head(interviews)</span><span class="w">
</span><span class="n">head_interviews</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">interviews</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">:</code> is a special function that creates numeric vectors of integers in increasing
or decreasing order, test <code class="language-plaintext highlighter-rouge">1:10</code> and <code class="language-plaintext highlighter-rouge">10:1</code> for instance.</p>

<p>You can also exclude certain indices of a data frame using the “<code class="language-plaintext highlighter-rouge">-</code>” sign:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">interviews</span><span class="p">[,</span><span class="w"> </span><span class="m">-1</span><span class="p">]</span><span class="w">          </span><span class="c1"># The whole data frame, except the first column</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code># A tibble: 131 x 13
   village interview_date      no_membrs years_liv respondent_wall… rooms
   &lt;chr&gt;   &lt;dttm&gt;                  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt;
 1 God     2016-11-17 00:00:00         3         4 muddaub              1
 2 God     2016-11-17 00:00:00         7         9 muddaub              1
 3 God     2016-11-17 00:00:00        10        15 burntbricks          1
 4 God     2016-11-17 00:00:00         7         6 burntbricks          1
 5 God     2016-11-17 00:00:00         7        40 burntbricks          1
 6 God     2016-11-17 00:00:00         3         3 muddaub              1
 7 God     2016-11-17 00:00:00         6        38 muddaub              1
 8 Chirod… 2016-11-16 00:00:00        12        70 burntbricks          3
 9 Chirod… 2016-11-16 00:00:00         8         6 burntbricks          1
10 Chirod… 2016-12-16 00:00:00        12        23 burntbricks          5
# … with 121 more rows, and 7 more variables: memb_assoc &lt;chr&gt;,
#   affect_conflicts &lt;chr&gt;, liv_count &lt;dbl&gt;, items_owned &lt;chr&gt;, no_meals &lt;dbl&gt;,
#   months_lack_food &lt;chr&gt;, instanceID &lt;chr&gt;
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">interviews</span><span class="p">[</span><span class="o">-</span><span class="nf">c</span><span class="p">(</span><span class="m">7</span><span class="o">:</span><span class="m">131</span><span class="p">),</span><span class="w"> </span><span class="p">]</span><span class="w">   </span><span class="c1"># Equivalent to head(interviews)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code># A tibble: 6 x 14
  key_ID village interview_date      no_membrs years_liv respondent_wall… rooms
   &lt;dbl&gt; &lt;chr&gt;   &lt;dttm&gt;                  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt;
1      1 God     2016-11-17 00:00:00         3         4 muddaub              1
2      1 God     2016-11-17 00:00:00         7         9 muddaub              1
3      3 God     2016-11-17 00:00:00        10        15 burntbricks          1
4      4 God     2016-11-17 00:00:00         7         6 burntbricks          1
5      5 God     2016-11-17 00:00:00         7        40 burntbricks          1
6      6 God     2016-11-17 00:00:00         3         3 muddaub              1
# … with 7 more variables: memb_assoc &lt;chr&gt;, affect_conflicts &lt;chr&gt;,
#   liv_count &lt;dbl&gt;, items_owned &lt;chr&gt;, no_meals &lt;dbl&gt;, months_lack_food &lt;chr&gt;,
#   instanceID &lt;chr&gt;
</code></pre></div></div>

<p>Data frames can be subset by calling indices (as shown previously), but also by calling their column names directly:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">interviews</span><span class="p">[</span><span class="s2">"village"</span><span class="p">]</span><span class="w">       </span><span class="c1"># Result is a data frame</span><span class="w">
</span><span class="n">interviews</span><span class="p">[,</span><span class="w"> </span><span class="s2">"village"</span><span class="p">]</span><span class="w">     </span><span class="c1"># Result is a data frame</span><span class="w">
</span><span class="n">interviews</span><span class="p">[[</span><span class="s2">"village"</span><span class="p">]]</span><span class="w">     </span><span class="c1"># Result is a vector</span><span class="w">
</span><span class="n">interviews</span><span class="o">$</span><span class="n">village</span><span class="w">          </span><span class="c1"># Result is a vector</span><span class="w">
</span></code></pre></div></div>

<p>In RStudio, you can use the autocompletion feature to get the full and correct names of the columns.</p>

<blockquote class="challenge">
  <h2 id="exercise">Exercise</h2>

  <ol>
    <li>
      <p>Create a data frame (<code class="language-plaintext highlighter-rouge">interviews_100</code>) containing only the data in
row 100 of the <code class="language-plaintext highlighter-rouge">interviews</code> dataset.</p>
    </li>
    <li>
      <p>Notice how <code class="language-plaintext highlighter-rouge">nrow()</code> gave you the number of rows in a data frame?</p>

      <ul>
        <li>Use that number to pull out just that last row in the data frame.</li>
        <li>Compare that with what you see as the last row using <code class="language-plaintext highlighter-rouge">tail()</code> to make
sure it’s meeting expectations.</li>
        <li>Pull out that last row using <code class="language-plaintext highlighter-rouge">nrow()</code> instead of the row number.</li>
        <li>Create a new data frame (<code class="language-plaintext highlighter-rouge">interviews_last</code>) from that last row.</li>
      </ul>
    </li>
    <li>
      <p>Using the number of rows in the interviews dataset that you found in 
question 2, extract the row that is in the middle of the dataset. Store
the content of this middle row in an object named <code class="language-plaintext highlighter-rouge">interviews_middle</code>.
(hint: This dataset has an odd number of rows, so finding the middle is a
bit trickier than dividing n_rows by 2. Use the median( ) function and what
you’ve learned about sequences in R to extract the middle row!</p>
    </li>
    <li>
      <p>Combine <code class="language-plaintext highlighter-rouge">nrow()</code> with the <code class="language-plaintext highlighter-rouge">-</code> notation above to reproduce the behavior of
<code class="language-plaintext highlighter-rouge">head(interviews)</code>, keeping just the first through 6th rows of the interviews
dataset.</p>
    </li>
  </ol>

  <blockquote class="solution">
    <h2 id="solution">Solution</h2>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## 1.</span><span class="w">
</span><span class="n">interviews_100</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">interviews</span><span class="p">[</span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="c1">## 2.</span><span class="w">
</span><span class="c1"># Saving `n_rows` to improve readability and reduce duplication</span><span class="w">
</span><span class="n">n_rows</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">nrow</span><span class="p">(</span><span class="n">interviews</span><span class="p">)</span><span class="w">
</span><span class="n">interviews_last</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">interviews</span><span class="p">[</span><span class="n">n_rows</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="c1">## 3.</span><span class="w">
</span><span class="n">interviews_middle</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">interviews</span><span class="p">[</span><span class="n">median</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="n">n_rows</span><span class="p">),</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="c1">## 4.</span><span class="w">
</span><span class="n">interviews_head</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">interviews</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="m">7</span><span class="o">:</span><span class="n">n_rows</span><span class="p">),</span><span class="w"> </span><span class="p">]</span><span class="w">
</span></code></pre></div>    </div>
  </blockquote>
</blockquote>

<h2 id="factors">Factors</h2>

<p>R has a special data class, called factor, to deal with categorical data that
you may encounter when creating plots or doing statistical analyses. Factors are
very useful and actually contribute to making R particularly well suited to
working with data. So we are going to spend a little time introducing them.</p>

<p>Factors represent categorical data. They are stored as integers associated with
labels and they can be ordered (ordinal) or unordered (nominal). Factors
create a structured  relation between the different levels (values) of a
categorical variable, such as days of the week or responses to a question in
a survey. This can make it easier to see how one element relates to the
other elements in a column. While factors look (and often behave) like 
character vectors, they are actually treated as integer vectors by <code class="language-plaintext highlighter-rouge">R</code>. So 
you need to be very careful when treating them as strings.</p>

<p>Once created, factors can only contain a pre-defined set of values, known as
<em>levels</em>. By default, R always sorts levels in alphabetical order. For
instance, if you have a factor with 2 levels:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">respondent_floor_type</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s2">"earth"</span><span class="p">,</span><span class="w"> </span><span class="s2">"cement"</span><span class="p">,</span><span class="w"> </span><span class="s2">"cement"</span><span class="p">,</span><span class="w"> </span><span class="s2">"earth"</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p>R will assign <code class="language-plaintext highlighter-rouge">1</code> to the level <code class="language-plaintext highlighter-rouge">"cement"</code> and <code class="language-plaintext highlighter-rouge">2</code> to the level <code class="language-plaintext highlighter-rouge">"earth"</code>
(because <code class="language-plaintext highlighter-rouge">c</code> comes before <code class="language-plaintext highlighter-rouge">e</code>, even though the first element in this vector is
<code class="language-plaintext highlighter-rouge">"earth"</code>). You can see this by using the function <code class="language-plaintext highlighter-rouge">levels()</code> and you can find
the number of levels using <code class="language-plaintext highlighter-rouge">nlevels()</code>:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">levels</span><span class="p">(</span><span class="n">respondent_floor_type</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] "cement" "earth" 
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nlevels</span><span class="p">(</span><span class="n">respondent_floor_type</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 2
</code></pre></div></div>

<p>Sometimes, the order of the factors does not matter. Other times you might want
to specify the order because it is meaningful (e.g., “low”, “medium”, “high”).
It may improve your visualization, or it may be required by a particular type of
analysis. Here, one way to reorder our levels in the <code class="language-plaintext highlighter-rouge">respondent_floor_type</code> vector would be:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">respondent_floor_type</span><span class="w"> </span><span class="c1"># current order</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] earth  cement cement earth 
Levels: cement earth
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">respondent_floor_type</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">respondent_floor_type</span><span class="p">,</span><span class="w"> </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"earth"</span><span class="p">,</span><span class="w"> </span><span class="s2">"cement"</span><span class="p">))</span><span class="w">
</span><span class="n">respondent_floor_type</span><span class="w"> </span><span class="c1"># after re-ordering</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] earth  cement cement earth 
Levels: earth cement
</code></pre></div></div>

<p>In R’s memory, these factors are represented by integers (1, 2), but are more
informative than integers because factors are self describing: <code class="language-plaintext highlighter-rouge">"cement"</code>,
<code class="language-plaintext highlighter-rouge">"earth"</code> is more descriptive than <code class="language-plaintext highlighter-rouge">1</code>, and <code class="language-plaintext highlighter-rouge">2</code>. Which one is “earth”? You
wouldn’t be able to tell just from the integer data. Factors, on the other hand,
have this information built in. It is particularly helpful when there are many
levels. It also makes renaming levels easier. Let’s say we made a mistake and need to recode “cement” to “brick”.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">levels</span><span class="p">(</span><span class="n">respondent_floor_type</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] "earth"  "cement"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">levels</span><span class="p">(</span><span class="n">respondent_floor_type</span><span class="p">)[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"brick"</span><span class="w">
</span><span class="n">levels</span><span class="p">(</span><span class="n">respondent_floor_type</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] "earth" "brick"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">respondent_floor_type</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] earth brick brick earth
Levels: earth brick
</code></pre></div></div>

<p>So far, your factor is unordered, like a nominal variable. R does not know the 
difference between a nominal and an ordinal variable. You make your factor an
ordered factor by using the <code class="language-plaintext highlighter-rouge">ordered=TRUE</code> option inside your factor function.
Note how the reported levels changed from the unordered factor above to the
ordered version below. Ordered levels use the less than sign <code class="language-plaintext highlighter-rouge">&lt;</code> to denote
level ranking.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">respondent_floor_type_ordered</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">respondent_floor_type</span><span class="p">,</span><span class="w"> </span><span class="n">ordered</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="n">respondent_floor_type_ordered</span><span class="w"> </span><span class="c1"># after setting as ordered factor</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] earth brick brick earth
Levels: earth &lt; brick
</code></pre></div></div>

<h3 id="converting-factors">Converting factors</h3>

<p>If you need to convert a factor to a character vector, you use
<code class="language-plaintext highlighter-rouge">as.character(x)</code>.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">as.character</span><span class="p">(</span><span class="n">respondent_floor_type</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] "earth" "brick" "brick" "earth"
</code></pre></div></div>

<p>Converting factors where the levels appear as numbers (such as concentration
levels, or years) to a numeric vector is a little trickier. The <code class="language-plaintext highlighter-rouge">as.numeric()</code>
function returns the index values of the factor, not its levels, so it will
result in an entirely new (and unwanted in this case) set of numbers.
One method to avoid this is to convert factors to characters, and then to numbers.
Another method is to use the <code class="language-plaintext highlighter-rouge">levels()</code> function. Compare:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">year_fct</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1990</span><span class="p">,</span><span class="w"> </span><span class="m">1983</span><span class="p">,</span><span class="w"> </span><span class="m">1977</span><span class="p">,</span><span class="w"> </span><span class="m">1998</span><span class="p">,</span><span class="w"> </span><span class="m">1990</span><span class="p">))</span><span class="w">
</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">year_fct</span><span class="p">)</span><span class="w">                     </span><span class="c1"># Wrong! And there is no warning...</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 3 2 1 4 3
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">year_fct</span><span class="p">))</span><span class="w">       </span><span class="c1"># Works...</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 1990 1983 1977 1998 1990
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">as.numeric</span><span class="p">(</span><span class="n">levels</span><span class="p">(</span><span class="n">year_fct</span><span class="p">))[</span><span class="n">year_fct</span><span class="p">]</span><span class="w">   </span><span class="c1"># The recommended way.</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1] 1990 1983 1977 1998 1990
</code></pre></div></div>

<p>Notice that in the recommended <code class="language-plaintext highlighter-rouge">levels()</code> approach, three important steps occur:</p>

<ul>
  <li>We obtain all the factor levels using <code class="language-plaintext highlighter-rouge">levels(year_fct)</code></li>
  <li>We convert these levels to numeric values using <code class="language-plaintext highlighter-rouge">as.numeric(levels(year_fct))</code></li>
  <li>We then access these numeric values using the underlying integers of the
vector <code class="language-plaintext highlighter-rouge">year_fct</code> inside the square brackets</li>
</ul>

<h3 id="renaming-factors">Renaming factors</h3>

<p>When your data is stored as a factor, you can use the <code class="language-plaintext highlighter-rouge">plot()</code> function to get a
quick glance at the number of observations represented by each factor level.
Let’s extract the <code class="language-plaintext highlighter-rouge">memb_assoc</code> column from our data frame, convert it into a
factor, and use it to look at the number of interview respondents who were or
were not members of an irrigation association:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## create a vector from the data frame column "memb_assoc"</span><span class="w">
</span><span class="n">memb_assoc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">interviews</span><span class="o">$</span><span class="n">memb_assoc</span><span class="w">
</span><span class="c1">## convert it into a factor</span><span class="w">
</span><span class="n">memb_assoc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.factor</span><span class="p">(</span><span class="n">memb_assoc</span><span class="p">)</span><span class="w">
</span><span class="c1">## let's see what it looks like</span><span class="w">
</span><span class="n">memb_assoc</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [1] &lt;NA&gt; yes  &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; no   yes  no   no   &lt;NA&gt; yes  no   &lt;NA&gt; yes 
 [16] &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; no   &lt;NA&gt; &lt;NA&gt; no   no   no   &lt;NA&gt; no   yes  &lt;NA&gt;
 [31] &lt;NA&gt; yes  no   yes  yes  yes  &lt;NA&gt; yes  &lt;NA&gt; yes  &lt;NA&gt; no   no   &lt;NA&gt; no  
 [46] no   yes  &lt;NA&gt; &lt;NA&gt; yes  &lt;NA&gt; no   yes  no   &lt;NA&gt; yes  no   no   &lt;NA&gt; no  
 [61] yes  &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; no   yes  no   no   no   no   yes  &lt;NA&gt; no   yes  &lt;NA&gt;
 [76] &lt;NA&gt; yes  no   no   yes  no   no   yes  no   yes  no   no   &lt;NA&gt; yes  yes 
 [91] yes  yes  yes  no   no   no   no   yes  no   no   yes  yes  no   &lt;NA&gt; no  
[106] no   &lt;NA&gt; no   no   &lt;NA&gt; no   &lt;NA&gt; &lt;NA&gt; no   no   no   no   yes  no   no  
[121] no   no   no   no   no   no   no   no   no   yes  &lt;NA&gt;
Levels: no yes
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## bar plot of the number of interview respondents who were</span><span class="w">
</span><span class="c1">## members of irrigation association:</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">memb_assoc</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-02-factor-plot-default-order-1.png" title="plot of chunk factor-plot-default-order" alt="plot of chunk factor-plot-default-order" width="612" style="display: block; margin: auto;" /></p>

<p>Looking at the plot compared to the output of the vector, we can see that in
addition to “no”s and “yes”s, there are some respondents for which the
information about whether they were part of an irrigation association hasn’t
been recorded, and encoded as missing data. They do not appear on the plot.
Let’s encode them differently so they can counted and visualized in our plot.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## Let's recreate the vector from the data frame column "memb_assoc"</span><span class="w">
</span><span class="n">memb_assoc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">interviews</span><span class="o">$</span><span class="n">memb_assoc</span><span class="w">
</span><span class="c1">## replace the missing data with "undetermined"</span><span class="w">
</span><span class="n">memb_assoc</span><span class="p">[</span><span class="nf">is.na</span><span class="p">(</span><span class="n">memb_assoc</span><span class="p">)]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"undetermined"</span><span class="w">
</span><span class="c1">## convert it into a factor</span><span class="w">
</span><span class="n">memb_assoc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.factor</span><span class="p">(</span><span class="n">memb_assoc</span><span class="p">)</span><span class="w">
</span><span class="c1">## let's see what it looks like</span><span class="w">
</span><span class="n">memb_assoc</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  [1] undetermined yes          undetermined undetermined undetermined
  [6] undetermined no           yes          no           no          
 [11] undetermined yes          no           undetermined yes         
 [16] undetermined undetermined undetermined undetermined undetermined
 [21] no           undetermined undetermined no           no          
 [26] no           undetermined no           yes          undetermined
 [31] undetermined yes          no           yes          yes         
 [36] yes          undetermined yes          undetermined yes         
 [41] undetermined no           no           undetermined no          
 [46] no           yes          undetermined undetermined yes         
 [51] undetermined no           yes          no           undetermined
 [56] yes          no           no           undetermined no          
 [61] yes          undetermined undetermined undetermined no          
 [66] yes          no           no           no           no          
 [71] yes          undetermined no           yes          undetermined
 [76] undetermined yes          no           no           yes         
 [81] no           no           yes          no           yes         
 [86] no           no           undetermined yes          yes         
 [91] yes          yes          yes          no           no          
 [96] no           no           yes          no           no          
[101] yes          yes          no           undetermined no          
[106] no           undetermined no           no           undetermined
[111] no           undetermined undetermined no           no          
[116] no           no           yes          no           no          
[121] no           no           no           no           no          
[126] no           no           no           no           yes         
[131] undetermined
Levels: no undetermined yes
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## bar plot of the number of interview respondents who were</span><span class="w">
</span><span class="c1">## members of irrigation association:</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">memb_assoc</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../fig/rmd-02-factor-plot-reorder-1.png" title="plot of chunk factor-plot-reorder" alt="plot of chunk factor-plot-reorder" width="612" style="display: block; margin: auto;" /></p>

<blockquote class="challenge">
  <h2 id="exercise-1">Exercise</h2>

  <ul>
    <li>
      <p>Rename the levels of the factor to have the first letter in uppercase:
“No”,”Undetermined”, and “Yes”.</p>
    </li>
    <li>
      <p>Now that we have renamed the factor level to “Undetermined”, can you
recreate the barplot such that “Undetermined” is last (after “Yes”)?</p>
    </li>
  </ul>

  <blockquote class="solution">
    <h2 id="solution-1">Solution</h2>

    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">levels</span><span class="p">(</span><span class="n">memb_assoc</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"No"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Undetermined"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Yes"</span><span class="p">)</span><span class="w">
</span><span class="n">memb_assoc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">memb_assoc</span><span class="p">,</span><span class="w"> </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"No"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Yes"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Undetermined"</span><span class="p">))</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">memb_assoc</span><span class="p">)</span><span class="w">
</span></code></pre></div>    </div>

    <p><img src="../fig/rmd-02-factor-plot-exercise-1.png" title="plot of chunk factor-plot-exercise" alt="plot of chunk factor-plot-exercise" width="612" style="display: block; margin: auto;" /></p>
  </blockquote>
</blockquote>

<h2 id="formatting-dates">Formatting Dates</h2>

<p>One of the most common issues that new (and experienced!) R users have is
converting date and time information into a variable that is appropriate and
usable during analyses. As a reminder from earlier in this lesson, the best
practice for dealing with date data is to ensure that each component of your
date is stored as a separate variable. In our dataset, we have a
column <code class="language-plaintext highlighter-rouge">interview_date</code> which contains information about the
year, month, and day that the interview was conducted. Let’s
convert those dates into three separate columns.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">str</span><span class="p">(</span><span class="n">interviews</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<p>We are going to use the package <strong><code class="language-plaintext highlighter-rouge">lubridate</code></strong>, which is included in the
<strong><code class="language-plaintext highlighter-rouge">tidyverse</code></strong> installation but not loaded by default, so we have to load 
it explicitly with <code class="language-plaintext highlighter-rouge">library(lubridate)</code>.</p>

<p>Start by loading the required package:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">lubridate</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>The lubridate function <code class="language-plaintext highlighter-rouge">ymd()</code> takes a vector representing year, month, and day, and converts it to a
<code class="language-plaintext highlighter-rouge">Date</code> vector. <code class="language-plaintext highlighter-rouge">Date</code> is a class of data recognized by R as being a date and can
be manipulated as such. The argument that the function requires is flexible,
but, as a best practice, is a character vector formatted as “YYYY-MM-DD”.</p>

<p>Let’s extract our <code class="language-plaintext highlighter-rouge">interview_date</code> column and inspect the structure:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dates</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">interviews</span><span class="o">$</span><span class="n">interview_date</span><span class="w">
</span><span class="n">str</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code> POSIXct[1:131], format: "2016-11-17" "2016-11-17" "2016-11-17" "2016-11-17" "2016-11-17" ...
</code></pre></div></div>

<p>When we imported the data in R, <code class="language-plaintext highlighter-rouge">read_csv()</code> recognized that this column contained date information. We can now use the <code class="language-plaintext highlighter-rouge">day()</code>, <code class="language-plaintext highlighter-rouge">month()</code> and  <code class="language-plaintext highlighter-rouge">year()</code> functions to extract this information from the date, and create new columns in our data frame to store it:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">interviews</span><span class="o">$</span><span class="n">day</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">day</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span><span class="w">
</span><span class="n">interviews</span><span class="o">$</span><span class="n">month</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">month</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span><span class="w">
</span><span class="n">interviews</span><span class="o">$</span><span class="n">year</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">year</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span><span class="w">
</span><span class="n">interviews</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code># A tibble: 131 x 17
   key_ID village interview_date      no_membrs years_liv respondent_wall… rooms
    &lt;dbl&gt; &lt;chr&gt;   &lt;dttm&gt;                  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt;
 1      1 God     2016-11-17 00:00:00         3         4 muddaub              1
 2      1 God     2016-11-17 00:00:00         7         9 muddaub              1
 3      3 God     2016-11-17 00:00:00        10        15 burntbricks          1
 4      4 God     2016-11-17 00:00:00         7         6 burntbricks          1
 5      5 God     2016-11-17 00:00:00         7        40 burntbricks          1
 6      6 God     2016-11-17 00:00:00         3         3 muddaub              1
 7      7 God     2016-11-17 00:00:00         6        38 muddaub              1
 8      8 Chirod… 2016-11-16 00:00:00        12        70 burntbricks          3
 9      9 Chirod… 2016-11-16 00:00:00         8         6 burntbricks          1
10     10 Chirod… 2016-12-16 00:00:00        12        23 burntbricks          5
# … with 121 more rows, and 10 more variables: memb_assoc &lt;chr&gt;,
#   affect_conflicts &lt;chr&gt;, liv_count &lt;dbl&gt;, items_owned &lt;chr&gt;, no_meals &lt;dbl&gt;,
#   months_lack_food &lt;chr&gt;, instanceID &lt;chr&gt;, day &lt;int&gt;, month &lt;dbl&gt;,
#   year &lt;dbl&gt;
</code></pre></div></div>

<p>Notice the three new columns at the end of our data frame.</p>






<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>Use read_csv to read tabular data in R.</p>
</li>
    
    <li><p>Use factors to represent categorical data in R.</p>
</li>
    
  </ul>
</blockquote>

</article>



























  
  











<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../01-intro-to-r/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../03-dplyr-tidyr/index.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>


      
      






<footer>
  <div class="row">
    <div class="col-md-6 license" id="license-info" align="left">
	
	Licensed under <a href="">CC-BY 4.0</a> 2018–2020
	by <a href="https://carpentries.org/">The Carpentries</a>
        <br>
        Licensed under <a href="">CC-BY 4.0</a> 2016–2018
	by <a href="http://datacarpentry.org">Data Carpentry</a>
	
    </div>
    <div class="col-md-6 help-links" align="right">
	
	
	<a href="/edit//_episodes_rmd/02-starting-with-data.Rmd" data-checker-ignore>Edit on GitHub</a>
	
	
	/
	<a href="/blob//CONTRIBUTING.md" data-checker-ignore>Contributing</a>
	/
	<a href="/">Source</a>
	/
	<a href="/blob//CITATION" data-checker-ignore>Cite</a>
	/
	<a href="mailto:team@carpentries.org">Contact</a>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12" align="center">
      Using <a href="https://github.com/carpentries/styles/">The Carpentries style</a>
      version <a href="https://github.com/carpentries/styles/releases/tag/v9.5.3">9.5.3</a>.
    </div>
  </div>
</footer>

      
    </div>
    
<script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/bootstrap.min.js"></script>
<script src="../assets/js/lesson.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-37305346-2', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>
